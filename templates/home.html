{% extends "base.html" %}
{% load static %}
{% load image_filters %}
{% block title %}üíª Home{% endblock %}
{% block content %}

    <!-- üíª Hero Section -->
    <section id="home" class="home section">
      <div class="container home__container">
        <div class="home__content">
          <div class="home__text">
            <h1>{{ hero.greeting|safe }} <span><b>{{ hero.name }}</b></span> {{ hero.emoji }}</h1>
            <p>{{ hero.headline|safe }}</p>
            <p>{{ hero.subtext_1|safe }}</p>
            <p>{{ hero.subtext_2|safe }}</p>
            <p>{{ hero.subtext_3|safe }}</p>

            <div class="home__buttons">
              <a href="{% url 'projects' %}" class="button">View Projects</a>
              
              {% if hero.resume %}
                <a href="{{ hero.resume.url }}" class="button button--outline" download target="_blank" rel="noopener noreferrer">Download Resume</a>
              {% endif %}
              <a href="{% url 'contact' %}" class="button button--outline">Hire Me</a>
            </div>

            <div class="home__socials">
              {% for link in social_links %}
                <a href="{{ link.url }}" target="_blank">
                  <i class="uil uil-{{ link.platform }}"></i>
                </a>
              {% endfor %}
            </div>
          </div>

          <div class="home__image">
            <picture>
              <source srcset="{{ hero.profile_image|webp }}" type="image/webp">
              <img src="{{ hero.profile_image.url }}" alt="{{ hero.name }}" loading="lazy" decoding="async" />
            </picture>
          </div>
        </div>
      </div>
    </section>

    <!-- Stats Section -->
    <section class="stats-section">
      <div class="stats">
        <div class="stat">
          <i class="uil uil-award"></i>
          <h3>100%</h3>
          <p>Satisfaction Guaranteed</p>
        </div>
        <div class="stat">
          <i class="uil uil-users-alt"></i>
          <h3>30+</h3>
          <p>Clients Served</p>
        </div>
        <div class="stat">
          <i class="uil uil-check-circle"></i>
          <h3>40+</h3>
          <p>Projects Completed</p>
        </div>
        
      </div>
    </section>

    <!-- üìÇ About Section -->
    <section class="section" id="about">
      <div class="container">
        <h2 class="section-title">üíº {{ about.title }}   </h2>
        
        <div class="project-grid">
          <div class="project-card">
            <h3><em>{{ about.tagline|safe }}</em></h3>
            <p> {{ about.description_1|safe }}</p>
            <p> {{ about.description_2|safe }}</p>
            <p> {{ about.description_3|safe }}</p>
          </div>

          <div class="project-card">
            <h3><em>üõ∏ My Tech Stack:</em></h3>
            <p>{{ about.tech_stack|safe }}</p>
            
          </div>
        </div>
      </div>
    </section>


    <!-- üíº Skills Section -->
    <section class="section" id="skills">
      <div class="container">
        <h2 class="section-title">üéÄ What I Do
        </h2>
        <div class="project-grid">
          {% for skill_group in skills %}
            <div class="project-card">
              <h3>{{ skill_group.icon }} <b>{{ skill_group.category }}</b></h3>
              <p>{{ skill_group.stack|safe}}</p>
            </div>
            {% empty %}
            <p>No skills available yet.</p>
          {% endfor %}
        </div>
      </div>
    </section>


    <!-- üß™ Projects Section -->
    <section class="section" id="projects">
      <div class="container">
        <h2 class="section-title">üìö Projects </h2>
        <!-- Project Category Filters -->
        <div class="category-search">
          <h3>Filter by Category</h3>
          <div class="category-filters">
            <a href="{% url 'projects' %}" class="category-filter all">All Projects</a>
            {% for category in project_categories %}
              <a href="{% url 'projects' %}?category={{ category.slug }}" class="category-filter">{{ category.name }}</a>
            {% endfor %}
            {% if project_categories|length >= 5 %}
              <a href="{% url 'projects' %}" class="category-filter">View All Categories</a>
            {% endif %}
          </div>
        </div>
        <div class="project-grid">
          {% for project in projects %}
            <div class="project-card">
              <picture>
                <source srcset="{{ project.image|webp }}" type="image/webp">
                <img src="{{ project.image.url }}" alt="{{ project.title }}" class="project-detail-image" loading="lazy" decoding="async"/>
              </picture>
              <h3>
                <a href="{% url 'project_details' project.slug %}" style="text-decoration: none;">
                {{ project.title }}
              </a>
              </h3>
              <!-- Add this inside your project card, after the meta information -->
              {% if project.category %}
                <div class="project-category">
                  <i class="uil uil-folder"></i> {{ project.category.name }}
                </div>
              {% endif %}
              <p>{{ project.description|truncatewords:30|safe }}</p>
              <div class="project-meta">
                <span><i class="uil uil-eye"></i> {{ project.views }} Views</span> 
                <span class="like-count"><i class="uil uil-heart"></i> {{ project.likes }} Likes</span> 
                <span><i class="uil uil-comment-alt-lines"></i> {{project.comments.count}} Comments</span> 

              </div>
              
              <div class="project-links">
                {% if project.repo_url %}<a href="{{ project.repo_url }}" target="_blank">View Code</a>{% endif %}
                {% if project.live_url %}<a href="{{ project.live_url }}" target="_blank">View Project</a>{% endif %}
                <a href="{% url 'project_details' project.slug %}" class="more-info">More Info</a>
              </div>
            
            </div>
            {% empty %}
            <p>No projects available.</p>
          {% endfor %}
        </div>
      </div>
    </section>

    <!-- üìù Blog Section -->
    <section class="section" id="blog">
      <div class="container">
        <h2 class="section-title">üìù Blog Posts </h2>
        <!-- Blog Category Filters -->
        <div class="category-search">
          <h3>Filter by Category</h3>
          <div class="category-filters">
            <a href="{% url 'blog' %}" class="category-filter all">All Posts</a>
            {% for category in blog_categories %}
              <a href="{% url 'blog' %}?category={{ category.slug }}" class="category-filter">{{ category.name }}</a>
            {% endfor %}
            {% if blog_categories|length >= 5 %}
              <a href="{% url 'blog' %}" class="category-filter">View All Categories</a>
            {% endif %}
          </div>
        </div>
        <div class="blog-grid">
          {% for post in blog_posts %}
            <div class="blog-card">
              <picture>
                <source srcset="{{ post.image|webp }}" type="image/webp">
                <img src="{{ post.image.url }}" alt="{{ post.title }}" class="blog-image" loading="lazy" decoding="async">
              </picture>
              <a href="{% url 'blog_detail' post.slug %}" class="blog-title-link" style="text-decoration: none;">
                <h3>{{ post.title }}</h3>
              </a>

              <!-- Add this inside your blog card, after the meta information -->
              {% if post.category %}
                <div class="blog-category">
                  <i class="uil uil-folder"></i> {{ post.category.name }}
                </div>
              {% endif %}
              <p>{{ post.excerpt|truncatewords:30|safe }}</p>
              <div class="blog-meta">
                <span><i class="uil uil-calendar-alt"></i> {{ post.created_at }}</span>
                <span><i class="uil uil-user"></i> {{ post.author }}</span>
                <span class="like-count"><i class="uil uil-heart"></i> {{ post.likes }} Likes</span> 
                <span><i class="uil uil-comment-alt-lines"></i> {{ post.comments.count }} Comments</h3></span>
              </div>
              
              <a href="{% url 'blog_detail' post.slug %}" target="_blank">Read More</a>
            </div>
          {% empty %}
            <p>No blog posts available.</p>
          {% endfor %}
        </div>
      </div>
    </section>

    <!-- üåü Testimonial Section -->
    <section class="testimonials section" id="testimonials">
      <div class="testimonial-container">
        <h2 class="section-title">üí¨ What My Clients Say </h2>

        <!-- ‚ú® Add Testimonial Button -->
<div class="add-testimonial-container" style="text-align:center; margin-bottom: 1.5rem;">
  {% if user.is_authenticated %}
    <button id="addTestimonialBtn" class="button button--outline">Add Testimonial</button>
  {% else %}
    <a href="{% url 'signup' %}" class="button button--outline">Sign Up to Add Testimonial</a>
  {% endif %}
</div>

<!-- üîΩ Hidden Form -->
<div id="testimonialForm" class="testimonial-form hidden">
  <form action="{% url 'add_testimonial' %}" method="POST" enctype="multipart/form-data" class="auth-container" style="max-width:500px;margin:auto;">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="button">Submit Testimonial</button>
  </form>
</div>

        <div class="testimonial-carousel">
          {% for testimonial in testimonials %}
          <div class="testimonial-card">
            <div class="testimonial-content">
              <!-- Left side: text -->
              <div class="testimonial-text">
                <h4>{{ testimonial.name }}</h4>
                {% if testimonial.role %}
                  <small>{{ testimonial.role }}</small>
                {% endif %}
                <p>{{ testimonial.message|safe }}</p>
              </div>

              <!-- Right side: image + stars -->
              
              <div class="testimonial-img">
                <!--{% if testimonial.image %}
                  <picture>
                    {% with image_url=testimonial.image.url|default:testimonial.image %}
                      <source srcset="{{ image_url|webp }}" type="image/webp">
                      <img src="{{ image_url }}" alt="{{ testimonial.name }}" loading="lazy" decoding="async">
                    {% endwith %}
                  </picture>
                {% endif %}-->

                <div class="testimonial-stars">
                  {% with ''|center:5 as range %}
                    {% for _ in range %}
                      {% if forloop.counter <= testimonial.rating %}
                        <i class="fas fa-star text-yellow-500"></i>
                      {% else %}
                        <i class="far fa-star text-yellow-500"></i>
                      {% endif %}
                    {% endfor %}
                  {% endwith %}
                </div>
              </div>

            </div>
          </div>
          {% endfor %}
        </div>

        <div class="carousel-buttons">
          <button id="prev">‚ùÆ</button>
          <button id="next">‚ùØ</button>
        </div>
      </div>
    </section>

{% endblock %}